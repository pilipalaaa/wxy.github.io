<!doctype html>
<html>
<head>
    <title>首页</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1" />
    <link href="lib/layui-v2.4.5/layui/css/layui.css" rel="stylesheet" />
    <link href="css/style.css" rel="stylesheet">
    <script src="lib/jquery/1.12.4/jquery.min.js"></script>
    <script src="lib/ECharts/echarts.min.js"></script>
    <script src="js/china.js"></script>
    <script src="lib/ECharts/theme/customed.js"></script>
    <script src="lib/layui-v2.4.5/layui/layui.js"></script>
    <link href="lib/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.min.css" rel="stylesheet">
    <script src="lib/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.min.js"></script>
    <!--[if lt IE 9]><script src="lib/html5shiv/r29/html5.min.js"></script><script src="lib/respond.js/1.4.2/respond.min.js"></script><![endif]-->
    <script>
        window.parent.hideSideAndFoot();
        //写cookies
        function setCookie(c_name, value, expiredays) {
            var exdate = new Date();
            exdate.setDate(exdate.getDate() + expiredays);
            document.cookie = c_name + "=" + escape(value) + ((expiredays == null) ? "" : ";expires=" + exdate.toGMTString());
        }

        //读取cookies
        function getCookie(name) {
            var arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");

            if (arr = document.cookie.match(reg))

                return (arr[2]);
            else
                return "";
        }
    </script>
    <style>
        h4{
            color: #4A90E2;
        }
        .clearfix li .hd .text p{
            color: #4A90E2;
        }
    </style>
</head>
<body style="background-image:url(../SystemStyle/Images/background3.jpg);background-size: 100% 100%;">
<div class="layui-row layui-col-space15">
    <div class="layui-col-md7">
        <!--**用能概览***********-->
        <div class="mainColBox">
            <div class="mainColHdTool clearfix" style="padding: 0 30px; line-height: 50px; border-bottom: 1px solid gray; color: #333; position: relative;">
                <h2 class="fl" style="color: #00F7DE">用能概览</h2>
                <span class="date fr energyDate" style="color: #00F7DE">2020-01-16</span>
            </div>
            <div class="mainColBd">
                <div class="main_yongneng">
                    <ul class="clearfix">
                        <li>
                            <div class="hd">
                                <div class="h3 energyToday">150.89<span>kWh</span></div>
                                <h4>今日累计用电</h4>
                                <div class="text">
                                    <p>比昨日同时段<span class="energyRate">11.77%</span><i class="iconfont up energyUpOrDown">&#xe78b;</i></p>
                                    <p>昨日总用电<span class="energyYesterday">135.00 <span>kWh</span></span></p>
                                </div>
                            </div>
                            <div class="bd">
                                <div class="chart" id="yongneng1">图表</div>
                            </div>
                        </li>
                        <li>
                            <div class="hd">
                                <div class="h3 energyToday2">3450.00<span>kWh</span></div>
                                <h4>本月累计用电</h4>
                                <div class="text">
                                    <p>比上月同时段<span class="energyRate2">6.95%</span><i class="iconfont up energyUpOrDown2">&#xe78b;</i></p>
                                    <p>上月总用电<span class="energyYesterday2">3210.26 kWh</span></p>
                                </div>
                            </div>
                            <div class="bd">
                                <div class="chart" id="yongneng2">图表</div>
                            </div>
                        </li>
                        <li>
                            <div class="hd">
                                <div class="h3 energyToday3">3450.00<span>kWh</span></div>
                                <h4>今年累计用电</h4>
                                <div class="text">
                                    <p>比去年同时段<span class="energyRate3">6.95%</span><i class="iconfont up energyUpOrDown3">&#xe78b;</i></p>
                                    <p>去年总用电<span class="energyYesterday3">3210.26 kWh</span></p>
                                </div>
                            </div>
                            <div class="bd">
                                <div class="chart" id="yongneng3">图表</div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!--**/用能概览***********-->
    </div>
    <div class="layui-col-md5">
        <!--**区域用电***********-->
        <div class="mainColBox" id="quyuyongdian" style="height: 330px;"></div>
        <script>
            var quyuyongdian = echarts.init(document.getElementById('quyuyongdian'));
            var quyuyongdianChart = {
                series: [{
                    name: 'china_map',
                    type: 'map',
                    mapType: 'china',
                    roam: false,
                    label: {
                        normal: {
                            show: false, //省份名称
                            textStyle:{
                                color:'white'
                            }
                        },
                        emphasis: {
                            show: true,
                            textStyle:{color:"#800080"}
                        }
                    },
                    itemStyle: {
                        normal: {
                            borderWidth: .5,
                            /*borderColor: '#FFFFFF',
                            areaColor:"#FFFFFF"*/
                            borderColor: '#FFFFFF',
                            areaColor: '#092DFF'
                        },
                        emphasis: {
                            borderWidth: .5,
                            borderColor: '#4b0082',
                            areaColor:"#ffdead"
                        }
                    },
                    data:[
                        {name:'上海'},
                        {name:'甘肃'},
                        {name:'云南'},
                        {name:'内蒙古'},
                        {name:'北京'},
                        {name:'台湾'},
                        {name:'吉林'},
                        {name:'四川'},
                        {name:'天津'},
                        {name:'宁夏'},
                        {name:'安徽'},
                        {name:'山东'},
                        {name:'山西'},
                        {name:'广东'},
                        {name:'广西'},
                        {name:'新疆'},
                        {name:'江苏'},
                        {name:'江西'},
                        {name:'河北'},
                        {name:'河南'},
                        {name:'浙江'},
                        {name:'海南'},
                        {name:'湖北'},
                        {name:'湖南'},
                        {name:'福建'},
                        {name:'贵州'},
                        {name:'辽宁'},
                        {name:'重庆'},
                        {name:'陕西'},
                        {name:'青海'},
                        {name:'黑龙江'}
                    ]
                }]
            };
            quyuyongdian.setOption(quyuyongdianChart);
            /*var quyuyongdianChart = {
                color: ['#5487f2'],
                title: {
                    subtextStyle: {
                        color: '#000'
                    },
                    right: '0',
                    subtext: '单位KWH'
                },
                grid: {
                    show: false,
                    top: '40',
                    left: '0',
                    right: '30',
                    bottom: '20',
                    containLabel: true,
                    borderColor: '#000'
                },
                xAxis: {
                    offset: '0',
                    axisLabel: {
                        show: false,
                        //formatter: '{value} kWh'
                    },
                    axisLine: {
                        lineStyle: { width: 1 }
                    },
                    //splitLine:{show: false}
                },
                yAxis: {
                    //show:false,
                    type: 'category',
                    splitLine: { show: false },
                    axisLine: {
                        lineStyle: { color: '#999' }
                    },
                    data: ["办公生活楼", "技术中心", "整车发运中心", "零配件配送中心", "总装车间", "涂装车间", "焊装车间"]
                },
                series: [{
                    name: '区域用电',
                    type: 'bar',
                    barWidth:'12px',
                    barCategoryGap: '20',//type为bar的间隙
                    label: {
                        offset: [0, 0],
                        //  normal: {
                        show: true,
                        position: 'right',
                        color: '#000',
                        //    }
                    },
                    data: [1120.45, 589.23, 728.15, 1219.29, 1932.83, 2402.22, 3780.06]
                }
                ]
            };
            function GetAmmeterData(t) {
                var json='';
                if(t==1){
                    json = {
                        DataTime:'2020-01-16',
                        YAxis:["办公生活楼", "技术中心", "整车发运中心", "零配件配送中心", "总装车间", "涂装车间", "焊装车间"],
                        XAxisData: [1120.45, 589.23, 728.15, 1219.29, 1932.83, 2402.22, 3780.06],
                    };
                }else{
                    json = {
                        DataTime:'2020-01',
                        YAxis:["办公生活楼", "技术中心", "整车发运中心", "零配件配送中心", "总装车间", "涂装车间", "焊装车间"],
                        XAxisData: [11200.45, 5890.23, 7280.15, 12190.29, 19320.83, 24020.22, 37800.06],
                    };
                }
                $(".ammeterTime").html(json.DataTime);
                quyuyongdianChart.yAxis.data = json.YAxis;
                quyuyongdianChart.series[0].data = json.XAxisData;
                quyuyongdian.setOption(quyuyongdianChart);
            }
            var type = 1;
            GetAmmeterData(type);
            function togleAmmeterTime(t,s) {
                if (type != t) {
                    type = t;
                    $(s).parent().parent().find("li").removeClass("on");
                    $(s).parent().addClass("on");
                    GetAmmeterData(type);
                }
            }*/
            /*function GetAmmeterData(t) {
                $.ajax({
                    url: '/Monitor/GetAmmeterEnergy?t=' + Date.parse(new Date()) +'&dateType='+t,
                    type: "Get",
                    success: function (data) {
                        var json = JSON.parse(data);
                        $(".ammeterTime").html(json.DataTime);
                        quyuyongdianChart.yAxis.data = json.YAxis;
                        quyuyongdianChart.series[0].data = json.XAxisData;
                        quyuyongdian.setOption(quyuyongdianChart);
                    }
                });
            }*/
        </script>
        <!--**/区域用电***********-->
    </div>
</div>
<!--**单日电量***********-->
<div class="layui-row layui-col-space15">
    <div class="layui-col-md12">
        <div class="mainColBox">
            <div class="mainColHdTool clearfix" style="padding: 0 30px; line-height: 50px; border-bottom: 1px solid gray; color: #333; position: relative;">
                <h2 class="fl" style="color: #00F7DE">当日总用电</h2>
                <span class="date fl todayEnergy" style="color: #00F7DE">2020-01-16 11:00</span> <a class="more fr" href="javascript:window.parent.gotoPage('../HTML/IndexMore.html')">更多&nbsp;&gt;</a>
            </div>
            <div class="mainColBd">
                <div class="main_zongyongdian">
                    <div class="chart" id="zongyongdian"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    var zongyongdian = echarts.init(document.getElementById('zongyongdian'));
    var zongyongdianChart = {
        color: ['#4ea8fa', '#6fc71e'],
        title: {
            //text: '有功电量',
            //subtext: '单位(KW)'
        },
        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'shadow',
                shadowStyle: {
                    color: 'rgba(150,150,150,0.1)'
                }
            },
            //formatter: '{b0}-{b1}<br />昨日: {c0}<br />今日: {c1}'
        },
        grid: {
            top: '50',
            left: '0',
            right: '0',
            bottom: '30',
            containLabel: true
        },
        legend: {
            data: ['今日用电量','昨日用电量'],
            align: 'left',
            //left:'50%',
            top: '10'

        },
        xAxis: {
            type: 'category',
            axisLine: {
                show: false,
                lineStyle: { color: '#999' }
            },
            data: [
                "00:00", "01:00", "02:00", "03:00", "04:00", "05:00", "06:00", "07:00", "08:00", "09:00", "10:00", "11:00", "12:00", "13:00", "14:00", "15:00", "16:00", "17:00", "18:00", "19:00", "20:00", "21:00", "22:00", "23:00"]
        },
        yAxis: {
            //max:'700',

            //type: 'value',
            axisLine: {
                show: false,
                lineStyle: { color: '#999' }
            },
            axisLabel: {
                formatter: '{value} kWh'
            }
        },
        series: [{
            name: '昨日用电量',
            type: 'line',
            //smooth: 'true',
            // barCategoryGap:'0',
            barGap: '0',
            data: [105, 248, 75, 180, 157, 80, 92, 74, 159, 270, 147, 243, 191, 97, 198, 235, 228, 213, 72, 227, 234, 110, 133]
        },
            {
                name: '今日用电量',
                type: 'line',
                //smooth: 'true',
                data: [187, 197, 244, 123, 107, 67, 53, 162, 199, 176, 64, 154, 65, 167, 246, 107, 231, 76, 214]
            }

        ]
    };

</script>
<!--**/单日电量***********-->
<!--**电量合计***********-->
<!--<div class="layui-row layui-col-space15">
    <div class="layui-col-md12">
        <div class="mainColBox">
            <div class="mainColHdTool clearfix">
                <div class="clearfix" style="padding: 0 100px;">
                    <h2 class="fl" style="margin-left: -100px;">电量合计</h2>
                    <div class="fr tab" style="margin-right: -100px;">
                        <ul class="clearfix">
                            <li class="on"><a href="javascript:;" onclick="togleSumAmmeterTime(1,this)">日</a></li>
                            <li><a href="javascript:;" onclick="togleSumAmmeterTime(2,this)">月</a></li>
                        </ul>
                    </div>
                    <form class="clearfix select">
                        <dl class="clearfix">
                            <dd class="clearfix sumEnergydd">
                                <span>选择电表&nbsp;&nbsp;<i>+</i></span>
                                <a href="javascript:;">总装车间<i class="iconfont">&#xe641;</i></a><a href="javascript:;">涂装车间<i class="iconfont">&#xe641;</i></a><a href="javascript:;">焊接车间<i class="iconfont">&#xe641;</i></a><a href="javascript:;">冲压车间<i class="iconfont">&#xe641;</i></a><a href="javascript:;">总装车间<i class="iconfont">&#xe641;</i></a><a href="javascript:;">涂装车间<i class="iconfont">&#xe641;</i></a><a href="javascript:;">焊接车间<i class="iconfont">&#xe641;</i></a><a href="javascript:;">冲压车间<i class="iconfont">&#xe641;</i></a>
                            </dd>
                            <dt>
                                <div class="dtContainer">
                                    <div class="hd">
                                        <ul class="clearfix sumEnergyul">
                                            <li>
                                                <label class="checkbox"><input type="checkbox">开清棉2万锭<i></i></label>
                                            </li>
                                            <li>
                                                <label class="checkbox"><input type="checkbox">开清棉2万锭<i></i></label>
                                            </li>
                                            <li>
                                                <label class="checkbox"><input type="checkbox">开清棉2万锭<i></i></label>
                                            </li>
                                            <li>
                                                <label class="checkbox"><input type="checkbox">开清棉2万锭<i></i></label>
                                            </li>
                                            <li>
                                                <label class="checkbox"><input type="checkbox">开清棉2万锭<i></i></label>
                                            </li>
                                            <li>
                                                <label class="checkbox"><input type="checkbox">开清棉2万锭<i></i></label>
                                            </li>
                                            <li>
                                                <label class="checkbox"><input type="checkbox">开清棉2万锭<i></i></label>
                                            </li>
                                            <li>
                                                <label class="checkbox"><input type="checkbox">开清棉2万锭<i></i></label>
                                            </li>
                                            <li>
                                                <label class="checkbox"><input type="checkbox">开清棉2万锭<i></i></label>
                                            </li>
                                            <li>
                                                <label class="checkbox"><input type="checkbox">开清棉2万锭<i></i></label>
                                            </li>
                                            <li>
                                                <label class="checkbox"><input type="checkbox">开清棉2万锭<i></i></label>
                                            </li>
                                            <li>
                                                <label class="checkbox"><input type="checkbox">开清棉2万锭<i></i></label>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="bd">
                                        <input class="btn reset" type="reset" value="重置">
                                        <input class="btn subBtn" type="button" value="完成">
                                    </div>
                                </div>
                            </dt>
                        </dl>
                    </form>
                </div>
            </div>
            <div class="mainColBd">
                <div class="main_dianliangheji">
                    <div class="chart" id="dianliangheji"></div>
                </div>
            </div>
        </div>
    </div>
</div>-->
<script>
    var dianliangheji = echarts.init(document.getElementById('dianliangheji'));
    var dianlianghejiChart = {
        color: ['#4ea8fa'],
        title: {
            //text: '有功电量',
            //subtext: '单位(KW)'
        },
        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'shadow',
                shadowStyle: {
                    color: 'rgba(150,150,150,0.1)'
                }
            },
        },
        grid: {
            top: '50',
            left: '0',
            right: '0',
            bottom: '30',
            containLabel: true
        },
        xAxis: {
            type: 'category',
            axisLine: {
                lineStyle: { color: '#999'}
            },
            data: ["00:00", "01:00", "02:00", "03:00", "04:00", "05:00", "06:00", "07:00", "08:00", "09:00", "10:00", "11:00", "12:00", "13:00", "14:00", "15:00", "16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"]
        },
        yAxis: {
            //max:'700',

            //type: 'value',
            axisLine: {
                lineStyle: { width: 1, color: '#999' }
            },
            axisLabel: {
                formatter: '{value} kWh'
            }
        },
        series: [{
            name: '总用电量',
            type: 'bar',
            barWidth: '30px',//30 20
            //smooth: 'true',
            // barCategoryGap:'0',
            barGap: '0',
            data:  [22730, 16550, 22245, 21802, 13659, 15643, 8017, 11950, 18215, 7600, 6823, 23647, 15573, 20636, 8666, 8648,7636, 18354, 14231, 10853, 24462, 15364, 21918, 7708],
        }
        ]
    };
    dianliangheji.setOption(dianlianghejiChart);
    var ammertIds = "";
    var sumtype = 1;
    function GetSumAmmeterData(t) {
        var json='';
        if(t==1){
            json = {
                XAxis: ["00:00", "00:01", "00:02", "00:03", "00:04", "00:05", "00:06", "00:07", "00:08", "00:09", "00:10", "00:11", "00:12", "00:13", "00:14", "00:15", "00:16","00:17","00:18","00:19","00:20","00:21","00:22","00:23"],
                YAxisData: [22730, 16550, 22245, 21802, 13659, 15643, 8017, 11950, 18215, 7600, 6823, 23647, 15573, 20636, 8666, 8648,7636, 18354, 14231, 10853, 24462, 15364, 21918, 7708],
            }
        }else{
            json = {
                XAxis: ["01-01", "01-02", "01-03", "01-04", "01-05", "01-06", "01-07", "01-08", "01-09", "01-10", "01-11", "01-12", "01-13", "01-14", "01-15", "01-16", "01-17","01-18","01-19","01-20","01-21","01-22","01-23","01-24","01-25","01-26","01-27","01-28","01-29","01-30","01-31"],
                YAxisData: [22730, 16550, 22245, 21802, 13659, 15643, 8017, 11950, 18215, 7600, 6823, 23647, 15573, 20636, 8666, 8648],
            }
        }
        dianlianghejiChart.xAxis.data = json.XAxis;
        dianlianghejiChart.series[0].data = json.YAxisData;
        dianliangheji.setOption(dianlianghejiChart);
        /*$.ajax({
            url: '/Monitor/GetAmmeterSumEnergy?t=' + Date.parse(new Date()) + '&dateType=' + t + '&ammerteIds=' + ammertIds,
            type: "Get",
            success: function (data) {
                var json = JSON.parse(data);
                dianlianghejiChart.xAxis.data = json.XAxis;
                dianlianghejiChart.series[0].data = json.YAxisData;
                dianliangheji.setOption(dianlianghejiChart);
            }
        });*/
    }
    function getMaxSumAmmeterData() {
        data = '1';
        ammertIds = data;
        checkBoxByAmmeterIds();
        GetSumAmmeterData(sumtype);
        /*$.ajax({
            url: '/Monitor/GetMaxAmmeterSumEnergy?t=' + Date.parse(new Date()) + '&dateType=' + sumtype,
            type: "Get",
            success: function (data) {
                ammertIds = data;
                checkBoxByAmmeterIds();
                GetSumAmmeterData(sumtype);
            }
        });*/
    }
    function togleSumAmmeterTime(t, s) {
        if (sumtype != t) {
            sumtype = t;
            if (t == 1) {
                dianlianghejiChart.series[0].barWidth = '30px';
            } else if (t == 2) {
                dianlianghejiChart.series[0].barWidth = '20px';
            }
            $(s).parent().parent().find("li").removeClass("on");
            $(s).parent().addClass("on");
            GetSumAmmeterData(sumtype);
        }
    }
    function getAllAmmeter(callback) {
        $(".sumEnergydd").find("a").remove();
        $(".sumEnergyul").html("");
        var $ul = $(".sumEnergyul");
        for (var i = 0; i < json.length; i++) {
            var obj = json[i];
            var $li = $("<li><label class= \"checkbox\" > <input type=\"checkbox\" value=\"" + 123 + "\">" + obj.Name + "<i></i></label></li >");
            $ul.append($li);
        }
        if (callback) {
            callback();
        }
        /*$.ajax({
            url: '/Monitor/GetAllAmmeter?t=' + Date.parse(new Date()),
            type: "Get",
            success: function (data) {
                var json = JSON.parse(data);
                var $ul = $(".sumEnergyul");
                for (var i = 0; i < json.length; i++) {
                    var obj = json[i];
                    var $li = $("<li><label class= \"checkbox\" > <input type=\"checkbox\" value=\"" + obj.Id + "\">" + obj.Name + "<i></i></label></li >");
                    $ul.append($li);
                }
                if (callback) {
                    callback();
                }
            }
        });*/
    }
    function checkBoxByAmmeterIds() {
        var tempIds = ',' + ammertIds + ',';
        $(".sumEnergyul :checkbox").each(function () {
            var tempId = $(this).val();
            if (tempIds.indexOf(tempId) > -1) {
                $(this).attr("checked", "checked");
                $(".sumEnergydd").append($("<a href=\"javascript:;\" ammeterId=\"" + $(this).val() + "\">" + $(this).parent().text() + "</a>"))
            }
        });
    }
    //$(function(){
    $(window).on("load", function () {
        $(".dtContainer .hd").mCustomScrollbar({
            theme: "dark",
            axis: "xy",
            scrollInertia: '200'
        });
        $(".dtContainer .hd .scrool").mCustomScrollbar({
            theme: "dark",
            axis: "y",
            scrollInertia: '200'
        });
        var taids = getCookie("ammertIds");
        if (taids && taids != '') {
            ammertIds = taids;
            getAllAmmeter(checkBoxByAmmeterIds);
            GetSumAmmeterData(sumtype);
        } else {
            getAllAmmeter(getMaxSumAmmeterData);
        }
    });
    $(".mainColHdTool .select dd span").click(function () { $(this).parent().parent().toggleClass("on"); });
    $(".mainColHdTool .select dd a").click(function () { $(this).remove(); });
    $(".subBtn").click(function () {
        $('.mainColHdTool .select dl').removeClass('on');
        ammertIds = "";
        $(".sumEnergydd").find("a").remove();
        $(".sumEnergyul :checkbox:checked").each(function () {
            if (ammertIds != "") {
                ammertIds += ",";
            }
            ammertIds += $(this).val();
            $(".sumEnergydd").append($("<a href=\"javascript:;\" ammeterId=\"" + $(this).val() + "\">" + $(this).parent().text() + "</a>"))
        });
        setCookie("ammertIds", ammertIds, 30);
        GetSumAmmeterData(sumtype);
    });
    /*var ammertIds = "";
    var sumtype = 1;
    function GetSumAmmeterData(t) {
        $.ajax({
            url: '/Monitor/GetAmmeterSumEnergy?t=' + Date.parse(new Date()) + '&dateType=' + t + '&ammerteIds=' + ammertIds,
            type: "Get",
            success: function (data) {
                var json = JSON.parse(data);
                dianlianghejiChart.xAxis.data = json.XAxis;
                dianlianghejiChart.series[0].data = json.YAxisData;
                dianliangheji.setOption(dianlianghejiChart);
            }
        });
    }
    function getMaxSumAmmeterData() {
        $.ajax({
            url: '/Monitor/GetMaxAmmeterSumEnergy?t=' + Date.parse(new Date()) + '&dateType=' + sumtype,
            type: "Get",
            success: function (data) {
                ammertIds = data;
                checkBoxByAmmeterIds();
                GetSumAmmeterData(sumtype);
            }
        });
    }
    function togleSumAmmeterTime(t, s) {
        if (sumtype != t) {
            sumtype = t;
            if (t == 1) {
                dianlianghejiChart.series[0].barWidth = '30px';
            } else if (t == 2) {
                dianlianghejiChart.series[0].barWidth = '20px';
            }
            $(s).parent().parent().find("li").removeClass("on");
            $(s).parent().addClass("on");
            GetSumAmmeterData(sumtype);
        }
    }
    function getAllAmmeter(callback) {
        $(".sumEnergydd").find("a").remove();
        $(".sumEnergyul").html("");
        $.ajax({
            url: '/Monitor/GetAllAmmeter?t=' + Date.parse(new Date()),
            type: "Get",
            success: function (data) {
                var json = JSON.parse(data);
                var $ul = $(".sumEnergyul");
                for (var i = 0; i < json.length; i++) {
                    var obj = json[i];
                    var $li = $("<li><label class= \"checkbox\" > <input type=\"checkbox\" value=\"" + obj.Id + "\">" + obj.Name + "<i></i></label></li >");
                    $ul.append($li);
                }
                if (callback) {
                    callback();
                }
            }
        });
    }
    function checkBoxByAmmeterIds() {
        var tempIds = ',' + ammertIds + ',';
        $(".sumEnergyul :checkbox").each(function () {
            var tempId = $(this).val();
            if (tempIds.indexOf(tempId) > -1) {
                $(this).attr("checked", "checked");
                $(".sumEnergydd").append($("<a href=\"javascript:;\" ammeterId=\"" + $(this).val() + "\">" + $(this).parent().text() + "</a>"))
            }
        });
    }
    //$(function(){
    $(window).on("load", function () {
        $(".dtContainer .hd").mCustomScrollbar({
            theme: "dark",
            axis: "xy",
            scrollInertia: '200'
        });
        $(".dtContainer .hd .scrool").mCustomScrollbar({
            theme: "dark",
            axis: "y",
            scrollInertia: '200'
        });
        var taids = getCookie("ammertIds");
        if (taids && taids != '') {
            ammertIds = taids;
            getAllAmmeter(checkBoxByAmmeterIds);
            GetSumAmmeterData(sumtype);
        } else {
            getAllAmmeter(getMaxSumAmmeterData);
        }
    });
    $(".mainColHdTool .select dd span").click(function () { $(this).parent().parent().toggleClass("on"); });
    $(".mainColHdTool .select dd a").click(function () { $(this).remove(); });
    $(".subBtn").click(function () {
        $('.mainColHdTool .select dl').removeClass('on');
        ammertIds = "";
        $(".sumEnergydd").find("a").remove();
        $(".sumEnergyul :checkbox:checked").each(function () {
            if (ammertIds != "") {
                ammertIds += ",";
            }
            ammertIds += $(this).val();
            $(".sumEnergydd").append($("<a href=\"javascript:;\" ammeterId=\"" + $(this).val() + "\">" + $(this).parent().text() + "</a>"))
        });
        setCookie("ammertIds", ammertIds, 30);
        GetSumAmmeterData(sumtype);
    });*/
    //});
</script>
<!--**/电量合计***********-->
<!--**用能概览JS 单日电量数据绑定***********-->
<script type="text/javascript">
    var yongneng1 = echarts.init(document.getElementById('yongneng1'));
    var yongneng2 = echarts.init(document.getElementById('yongneng2'));
    var yongneng3 = echarts.init(document.getElementById('yongneng3'));
    var yongneng_one = {
        color: ['#bacef9', '#6190f3'],
        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'shadow',
                shadowStyle: {
                    color: 'rgba(150,150,150,0.1)'//hover颜色
                }
            }
        },
        grid: {
            show: false,
            top: '0',
            left: '0',
            right: '0',
            bottom: '0',
            containLabel: true,
            borderColor: '#000'
        },
        legend: {
            data: ['昨日用能', '今日用能'],
            show: false,
            align: 'right',
            right: '40'
        },
        xAxis: {
            show: false,
            type: 'category',
            splitLine: { show: false },
            data: ["00:00", "01:00", "02:00", "03:00", "04:00", "05:00", "06:00", "07:00", "08:00", "09:00", "10:00", "11:00", "12:00", "13:00", "14:00", "15:00", "16:00", "17:00", "18:00", "19:00", "20:00", "21:00", "22:00", "23:00"]

        },
        yAxis: {
            axisLabel: {
                show: false,
                formatter: '{value} kWh'
            },
            axisLine: {
                lineStyle: { width: 0 }
            },
            splitLine: { show: false }
        },
        series: [{
            name: '昨日用能',
            areaStyle: { opacity: 0, color: '#000' },//填充色
            lineStyle: { color: '#bacef9' },//线条色
            itemStyle: { opacity: 0 },//小圆点
            type: 'line',
            //smooth: 'false',//平滑折线,不用注释
            //barGap: '0',//type为bar的间隙
            data: [137, 184, 110, 155, 110, 164, 114, 101, 168, 115, 145, 187, 173, 120, 156, 119, 104, 178, 184, 146, 160, 131, 117]
        },
            {
                name: '今日用能',
                areaStyle: { opacity: 1, color: '#dee8fd' },
                lineStyle: { color: '#6190f3' },
                itemStyle: { opacity: 0 },
                type: 'line',
                //smooth: 'false',//平滑折线,不用注释
                //barGap: '0',//type为bar的间隙
                data: [161, 174, 159, 132, 168, 188, 137, 182, 187, 122, 197, 144, 177, 139, 158, 171, 197, 117, 143]
            }
        ]
    };
    var yongneng_two = {
        color: ['#bacef9', '#6190f3'],
        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'shadow',
                shadowStyle: {
                    color: 'rgba(150,150,150,0.1)'//hover颜色
                }
            }
        },
        grid: {
            show: false,
            top: '0',
            left: '0',
            right: '0',
            bottom: '0',
            containLabel: true,
            borderColor: '#000'
        },
        legend: {
            data: ['上月用能', '本月同期'],
            show: false,
            align: 'right',
            right: '40'
        },
        xAxis: {
            show: false,
            type: 'category',
            splitLine: { show: false },
            data: ["1号", "2号", "3号", "4号", "5号", "6号", "7号", "8号", "9号", "10号", "11号", "12号", "13号", "14号", "15号", "16号", "17号", "18号", "19号", "20号", "21号", "22号", "23号", "24号", "25号", "26号", "27号", "28号", "29号", "30号", "31号"]
        },
        yAxis: {
            axisLabel: {
                show: false,
                formatter: '{value} kWh'
            },
            axisLine: {
                lineStyle: { width: 0 }
            },
            splitLine: { show: false }
        },
        series: [{
            name: '上月用能',
            areaStyle: { opacity: 0, color: '#000' },//填充色
            lineStyle: { color: '#bacef9' },//线条色
            itemStyle: { opacity: 0 },//小圆点
            type: 'line',
            //smooth: 'false',//平滑折线,不用注释
            //barGap: '0',//type为bar的间隙
            data: [3535, 3084, 3234, 3628, 3786, 3001, 3572, 3189, 3676, 3849, 3240, 3017, 3604, 3555, 3662, 3129, 3947, 3743, 3671, 3748, 3854, 3454, 3105, 3274, 3270, 3264, 3098, 3718, 3990, 3032, 3619]
        },
            {
                name: '本月用能',
                areaStyle: { opacity: 1, color: '#dee8fd' },
                lineStyle: { color: '#6190f3' },
                itemStyle: { opacity: 0 },
                type: 'line',
                //smooth: 'false',//平滑折线,不用注释
                //barGap: '0',//type为bar的间隙
                data: [3826, 3632, 3275, 3127, 3797, 3740, 3295, 3518, 3156, 3845, 3136, 3478, 3979, 3395, 3967, 3614, 3445]
            }
        ]
    };
    var yongneng_three = {
        color: ['#bacef9', '#6190f3'],
        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'shadow',
                shadowStyle: {
                    color: 'rgba(150,150,150,0.1)'//hover颜色
                }
            }
        },
        grid: {
            show: false,
            top: '0',
            left: '0',
            right: '0',
            bottom: '0',
            containLabel: true,
            borderColor: '#000'
        },
        legend: {
            data: ['去年用能', '今年用能'],
            show: false,
            align: 'right',
            right: '40'
        },
        xAxis: {
            show: false,
            type: 'category',
            splitLine: { show: false },
            data: ["1月", "2月", "3月", "4月", "5月", "6月", "7月", "8月", "9月", "10月", "11月", "12月",],
        },
        yAxis: {
            axisLabel: {
                show: false,
                formatter: '{value} kWh'
            },
            axisLine: {
                lineStyle: { width: 0 }
            },
            splitLine: { show: false }
        },
        series: [{
            name: '去年用能',
            areaStyle: { opacity: 0, color: '#000' },//填充色
            lineStyle: { color: '#bacef9' },//线条色
            itemStyle: { opacity: 0 },//小圆点
            type: 'line',
            //smooth: 'false',//平滑折线,不用注释
            //barGap: '0',//type为bar的间隙
            data: [49127, 45154, 46470, 45998, 47166, 42204, 41024, 48848, 42174, 40280, 49340, 45671]
        },
            {
                name: '今年用能',
                areaStyle: { opacity: 1, color: '#dee8fd' },
                lineStyle: { color: '#6190f3' },
                itemStyle: { opacity: 0 },
                type: 'line',
                //smooth: 'false',//平滑折线,不用注释
                //barGap: '0',//type为bar的间隙
                data: [48380, 45624, 47258, 44396, 40488, 47978, 44796, 42521, 42046]
            }
        ]
    };
    var json = {
        TodayTime: '2020-01-17',

        TodayAllEnergy: '1952120.00',
        DayUpRate: '1.33',
        YesterdayAllEnergy: '432080.00',

        YesterdayData: '[137, 184, 110, 155, 110, 164, 114, 101, 168, 115, 145, 187, 173, 120, 156, 119, 104, 178, 184, 146, 160, 131, 117]',
        TodayData: '[161, 174, 159, 132, 168, 188, 137, 182, 187, 122, 197, 144, 177, 139, 158, 171, 197, 117, 143]',

        MonthAllEnergy: '5661200.00',
        MonthUpRate: '0.84',
        LastMonthAllEnergy: '10148080.00',

        LastMonthData: '[3535, 3084, 3234, 3628, 3786, 3001, 3572, 3189, 3676, 3849, 3240, 3017, 3604, 3555, 3662, 3129, 3947, 3743, 3671, 3748, 3854, 3454, 3105, 3274, 3270, 3264, 3098, 3718, 3990, 3032, 3619]',
        MonthData: '[3826, 3632, 3275, 3127, 3797, 3740, 3295, 3518, 3156, 3845, 3136, 3478, 3979, 3395, 3967, 3614, 3445]',

        YearAllEnergy: '5661200.00',
        YearUpRate: '0',
        LastYearAllEnergy: '94787120.00',

        LastYearData: '[49127, 45154, 46470, 45998, 47166, 42204, 41024, 48848, 42174, 40280, 49340, 45671]',
        YearData: '[48380, 45624, 47258, 44396, 40488, 47978, 44796, 42521, 42046]',
        TodayTime2: '2020-01-17 12:00',
    };
    $(".energyDate").html(json.TodayTime);//用能概览 时间
    $(".energyToday").html(json.TodayAllEnergy + "<span>kWh</span>");//用能概览 今日用能
    $(".energyYesterday").html(json.YesterdayAllEnergy + "<span>kWh</span>");//用能概览 昨日用能
    $(".energyRate").html(json.DayUpRate);//用能概览 同期上涨
    if (json.DayIsUpOrDown == "down") {
        $(".energyUpOrDown").removeClass("up").addClass("down").html("&#xe78a;");
    }
    yongneng_one.series[0].data = JSON.parse(json.YesterdayData);
    yongneng_one.series[1].data = JSON.parse(json.TodayData);
    yongneng1.setOption(yongneng_one);

    $(".energyToday2").html(json.MonthAllEnergy + "<span>kWh</span>");//用能概览 本月用能
    $(".energyYesterday2").html(json.LastMonthAllEnergy + "<span>kWh</span>");//用能概览 上月用能
    $(".energyRate2").html(json.MonthUpRate);//用能概览 同期上涨
    if (json.MonthIsUpOrDown == "down") {
        $(".energyUpOrDown2").removeClass("up").addClass("down").html("&#xe78a;");
    }
    yongneng_two.series[0].data = JSON.parse(json.LastMonthData);
    yongneng_two.series[1].data = JSON.parse(json.MonthData);
    yongneng2.setOption(yongneng_two);

    $(".energyToday3").html(json.YearAllEnergy + "<span>kWh</span>");//用能概览 本月用能
    $(".energyYesterday3").html(json.LastYearAllEnergy + "<span>kWh</span>");//用能概览 上月用能
    $(".energyRate3").html(json.YearUpRate);//用能概览 同期上涨
    if (json.YearIsUpOrDown == "down") {
        $(".energyUpOrDown3").removeClass("up").addClass("down").html("&#xe78a;");
    }
    yongneng_three.series[0].data = JSON.parse(json.LastYearData);
    yongneng_three.series[1].data = JSON.parse(json.YearData);
    yongneng3.setOption(yongneng_three);

    $(".todayEnergy").html(json.TodayTime2);//当日用能 时间
    zongyongdianChart.series[0].data = JSON.parse(json.YesterdayData);
    zongyongdianChart.series[1].data = JSON.parse(json.TodayData);
    zongyongdian.setOption(zongyongdianChart);
    /*$.ajax({
        url: '/Monitor/GetUseEnergy?t=' + Date.parse(new Date()),
        type: "Get",
        success: function (data) {
            var json = JSON.parse(data);
            $(".energyDate").html(json.TodayTime);//用能概览 时间
            $(".energyToday").html(json.TodayAllEnergy + "<span>kWh</span>");//用能概览 今日用能
            $(".energyYesterday").html(json.YesterdayAllEnergy + "<span>kWh</span>");//用能概览 昨日用能
            $(".energyRate").html(json.DayUpRate);//用能概览 同期上涨
            if (json.DayIsUpOrDown == "down") {
                $(".energyUpOrDown").removeClass("up").addClass("down").html("&#xe78a;");
            }
            yongneng_one.series[0].data = JSON.parse(json.YesterdayData);
            yongneng_one.series[1].data = JSON.parse(json.TodayData);
            yongneng1.setOption(yongneng_one);

            $(".energyToday2").html(json.MonthAllEnergy + "<span>kWh</span>");//用能概览 本月用能
            $(".energyYesterday2").html(json.LastMonthAllEnergy + "<span>kWh</span>");//用能概览 上月用能
            $(".energyRate2").html(json.MonthUpRate);//用能概览 同期上涨
            if (json.MonthIsUpOrDown == "down") {
                $(".energyUpOrDown2").removeClass("up").addClass("down").html("&#xe78a;");
            }
            yongneng_two.series[0].data = JSON.parse(json.LastMonthData);
            yongneng_two.series[1].data = JSON.parse(json.MonthData);
            yongneng2.setOption(yongneng_two);

            $(".energyToday3").html(json.YearAllEnergy + "<span>kWh</span>");//用能概览 本月用能
            $(".energyYesterday3").html(json.LastYearAllEnergy + "<span>kWh</span>");//用能概览 上月用能
            $(".energyRate3").html(json.YearUpRate);//用能概览 同期上涨
            if (json.YearIsUpOrDown == "down") {
                $(".energyUpOrDown3").removeClass("up").addClass("down").html("&#xe78a;");
            }
            yongneng_three.series[0].data = JSON.parse(json.LastYearData);
            yongneng_three.series[1].data = JSON.parse(json.YearData);
            yongneng3.setOption(yongneng_three);

            $(".todayEnergy").html(json.TodayTime2);//当日用能 时间
            zongyongdianChart.series[0].data = JSON.parse(json.YesterdayData);
            zongyongdianChart.series[1].data = JSON.parse(json.TodayData);
            zongyongdian.setOption(zongyongdianChart);
        }
    });*/


</script>
<!--**/用能概览JS 单日电量数据绑定***********-->
<script>
    window.addEventListener("resize", () => {
        this.yongneng1.resize();
        this.yongneng2.resize();
        this.yongneng3.resize();
        this.zongyongdian.resize();
        this.dianliangheji.resize();
        this.quyuyongdian.resize();
    });
    layui.use('layer', function () {
        var layer = layui.layer;
        // layer.msg('最多选10个',{time: 1000});
    });
    function test() {
        $.ajax({
            url: '../Monitor/GetDayIndexDataEnergyMore?t=' + Date.parse(new Date()),
            type: "Get",
            success: function (data) {
                var json = JSON.parse(data);
                alert(data);
            }
        });
    }
    //test();
</script>
</body>
</html>
</html>